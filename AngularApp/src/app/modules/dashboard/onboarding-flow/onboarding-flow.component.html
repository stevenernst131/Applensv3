<div class="view-container">
    
        <ngx-smart-modal #publishModal identifier="publishModal">
            <div>
                <h4>Confirm?</h4>
                <hr style="margin-top: 10px;margin-bottom: 10px;">
                <span>Published changes will be live in Applens and App Services "Diagnose and Solve" blade for external customers if the detector is marked public.</span>
                
                <div style="margin-top:10px;margin-bottom: 10px">
                    <button type="button" class="btn btn-primary" (click)="publish()" [class.disabled]="modalPublishingButtonDisabled">{{modalPublishingButtonText}}</button>
                    <button type="button" class="btn btn-danger" (click)="publishModal.close()">Cancel</button>
                </div>
                
            </div>
            
                
        </ngx-smart-modal>

    <div *ngIf="showAlert" class="alert alert-container" [ngClass]="alertClass" role="alert">
        {{alertMessage}}
    </div>
    <loader-view *ngIf="!code" message="Starting onboarding flow ..."></loader-view>

    <div *ngIf="code" class="onboarding-container">
        <split [direction]="horizontal" gutterSize="8" gutterColor="#dff0ff">

            <split-area size="60">

                <split direction="vertical" gutterSize="8" gutterColor="rgb(249, 233, 212)">
                    <split-area size="85">
                        <div class="code-container-header">

                            <div class="file-tab active">
                                {{fileName}}
                            </div>

                            <div (click)="confirmPublish()" class="action-button publish-button" [class.disabled]="publishButtonDisabled">
                                <i class="fa fa-cloud-upload"></i>
                                {{publishButtonText}}
                            </div>

                            <div (click)="runCompilation()" class="action-button run-button" [ngClass]="{'disabled': runButtonDisabled }">
                                <i [ngClass]="runButtonIcon"></i>
                                {{runButtonText}}
                            </div>

                        </div>

                        <ngx-monaco-editor style="height:calc(100% - 50px)" [options]="editorOptions" [(ngModel)]="code"></ngx-monaco-editor>

                    </split-area>
                    <split-area size="15">
                        <div class="compilation-output-container">
                            <div *ngFor="let item of buildOutput" class="compilation-output">{{item}}</div>
                        </div>
                    </split-area>
                </split>

            </split-area>
            <split-area size="40">
                <div class="invocation-output-title-container">
                    <div class="invocation-title" [ngClass]="[!showDataSources ? 'active' : '']"  (click)="queryResponse ? showDataSources=false : false">
                        Detector Output
                    </div>
                    <div class="invocation-title" [ngClass]="[showDataSources ? 'active' : '']" (click)="queryResponse ? showDataSources=true : false">
                        Data Sources
                    </div>
                </div>

                <div style="padding:10px">
                    <detector-view *ngIf="queryResponse && !showDataSources" [detectorResponse]="queryResponse.invocationOutput" [startTime]="queryParamsService.startTime"
                        [endTime]="queryParamsService.endTime" [error]="errorState" [showEdit]="false"></detector-view>

                    <tab-data-sources *ngIf="queryResponse && showDataSources" [onboardingMode]="true" [detectorResponse]="queryResponse.invocationOutput">
                    </tab-data-sources>
                </div>

            </split-area>

        </split>
    </div>
</div>